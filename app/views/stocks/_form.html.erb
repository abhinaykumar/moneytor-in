<%= form_with(model: stock) do |form| %>
<% if stock.errors.any? %>
<div id="error_explanation">
    <h2><%= pluralize(stock.errors.count, "error") %> prohibited this stock from being saved:</h2>

    <ul>
        <% stock.errors.full_messages.each do |message| %>
        <li><%= message %></li>
        <% end %>
    </ul>
</div>
<% end %>

<div class="form-group" data-controller="autocomplete" data-autocomplete-url="<%= search_listed_stocks_path %>">
    <%= text_field(:name, '', class: 'form-control', placeholder: "Search for name of the company/stock", data: { target: "autocomplete.input" }) %>
    <%= form.hidden_field :listed_stock_id, data: { target: "autocomplete.hidden" } %>
    <ul class="list-group" data-target="autocomplete.results">
    </ul>
</div>

<div class="form-group">
    <%= form.label :investment_date %>
    <%= form.text_field :investment_date, class: 'form-control', data: { controller: "flatpickr", flatpickr_date_format: "Y-m-d", flatpickr_max_date: Time.zone.now } %>
</div>

<div class="form-group">
    <label for="brokerage">Brokerage in Rupees</label>
    <%= form.text_field :brokerage, class: 'form-control' %>
</div>

<div class="form-group">
    <%= form.label :price %>
    <%= form.text_field :price, class: 'form-control' %>
</div>

<div class="form-group">
    <% if stock.persisted? %>
    <div class="float-right">
        <%= link_to 'Destroy', stock, method: :delete, class: "text-danger", data: { confirm: 'Are you sure?' } %>
    </div>
    <% end %>

    <%= form.submit "Add Stock", class: 'btn btn-primary' %>

    <% if stock.persisted? %>
    <%= link_to "Cancel", stock, class: "btn btn-link" %>
    <% else %>
    <%= link_to "Cancel", root_path, class: "btn btn-link" %>
    <% end %>
</div>
<% end %>